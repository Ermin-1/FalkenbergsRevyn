@model FeedbackViewModel

@if (Model == null)
{
    <p>Model is null</p>
}
else
{
    <div class="container">
        <div class="feedback-section">

            <!-- Positiva Feedback -->
            <div class="feedback-category">
                <div class="d-flex justify-content-between">
                    <p class="category-btn">Positiva</p>
                    @await Html.PartialAsync("_FilterDropdown", new FeedbackCategoryViewModel
                       {
                           Title = "Positiva",
                           CurrentFilter = Model.CurrentFilterPositiva,
                           CategoryType = "Positiva",
                           Comments = Model.PositiveComments
                       })
                </div>
                <div class="feedback-list">
                    @foreach (var comment in Model.PositiveComments)
                    {
                        <div class="feedback-item">
                            <p class="ms-2">@comment.Content</p>
                            <p class="genererat">@comment.Responses?.FirstOrDefault()?.ResponseContent</p>
                            <button type="button" class="btn-small ms-2" data-bs-toggle="modal" data-bs-target="#hideModal-@comment.CommentId">Dölj från listan</button>
                            @await Html.PartialAsync("_HideModal", comment)
                        </div>
                    }
                </div>
            </div>

            <!-- Kritik Feedback -->
            <div class="feedback-category">
                <div class="d-flex justify-content-between">
                    <p class="category-btn">Kritik</p>
                    @await Html.PartialAsync("_FilterDropdown", new FeedbackCategoryViewModel
                       {
                           Title = "Kritik",
                           CurrentFilter = Model.CurrentFilterKritik,
                           CategoryType = "Kritik",
                           Comments = Model.CriticalComments
                       })
                </div>
                <div class="feedback-list">
                    @foreach (var comment in Model.CriticalComments)
                    {
                        <div class="feedback-item">
                            <p>@comment.Content</p>
                            <p class="answer @(string.IsNullOrEmpty(comment.Responses?.FirstOrDefault()?.ResponseContent) ? "bg-pink" : "bg-white")">
                                @(string.IsNullOrEmpty(comment.Responses?.FirstOrDefault()?.ResponseContent) ? "Ej svarat" : comment.Responses?.FirstOrDefault()?.ResponseContent)
                            </p>
                            @if (string.IsNullOrEmpty(comment.Responses?.FirstOrDefault()?.ResponseContent))
                            {
                                <button type="button" class="btn-small ms-2" data-bs-toggle="modal" data-bs-target="#answerModal-@comment.CommentId">Svara</button>
                            }
                            <button type="button" class="btn-small ms-2" data-bs-toggle="modal" data-bs-target="#hideModal-@comment.CommentId">Dölj från listan</button>
                            @await Html.PartialAsync("_AnswerModal", comment)
                            @await Html.PartialAsync("_HideModal", comment)
                        </div>
                    }
                </div>
            </div>

            <!-- Frågor Feedback -->
            <div class="feedback-category">
                <div class="d-flex justify-content-between">
                    <p class="category-btn">Frågor</p>
                    @await Html.PartialAsync("_FilterDropdown", new FeedbackCategoryViewModel
                       {
                           Title = "Frågor",
                           CurrentFilter = Model.CurrentFilterFrågor,
                           CategoryType = "Frågor",
                           Comments = Model.Questions
                       })
                </div>
                <div class="feedback-list">
                    @foreach (var comment in Model.Questions)
                    {
                        <div class="feedback-item">
                            <p>@comment.Content</p>
                            <p class="answer @(string.IsNullOrEmpty(comment.Responses?.FirstOrDefault()?.ResponseContent) ? "bg-pink" : "bg-white")">
                                @(string.IsNullOrEmpty(comment.Responses?.FirstOrDefault()?.ResponseContent) ? "Ej svarat" : comment.Responses?.FirstOrDefault()?.ResponseContent)
                            </p>
                            @if (string.IsNullOrEmpty(comment.Responses?.FirstOrDefault()?.ResponseContent))
                            {
                                <button type="button" class="btn-small ms-2" data-bs-toggle="modal" data-bs-target="#answerModal-@comment.CommentId">Svara</button>
                            }

                            <button type="button" class="btn-small ms-2" data-bs-toggle="modal" data-bs-target="#hideModal-@comment.CommentId">Dölj från listan</button>
                            @await Html.PartialAsync("_AnswerModal", comment)
                            @await Html.PartialAsync("_HideModal", comment)
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
}
@await Html.PartialAsync("_Styles")